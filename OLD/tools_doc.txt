Read this once; use the commands shown directly from your repo root (or adjust absolute paths). I assume your scripts live in ../Scripts relative to where you run commands — adapt paths if you run them from repo root.

Quick canonical workflow (recommended)

    Convert PDFs to Markdown (text-only) — tools_pdf_to_md_textonly.py
    Connect converted MDs to existing PDF entries (if PDF entries already exist) — tools_connect_md_to_pdf_index.py (dry-run first)
    Run the sync to add any truly new files to index.html (interactive or yes-to-all) — tools_sync_index_with_fs_orig.py or wrapper
    Merge duplicate categories (if created multiple same-named sections) — tools_merge_duplicate_categories_Version2.py (dry-run first)
    Reassign/move mis-categorized entries interactively — tools_reassign_index_entries_Version2.py
    Check for any remaining unreferenced files — tools_unreferences_files.py
    Commit changes and housekeeping (.gitignore, remove .DS_Store, remove unneeded backups)

Per-script guide

../Scripts/tools_pdf_to_md_textonly.py

    Purpose: Convert text-based PDFs into simple Markdown files (md_outputs/<pdf-stem>.md). Uses PyMuPDF/html2text per the header you have.
    When to run: Before any index updates if you want MD previews and searchable text.
    Why: Creates readable MD versions for previewing and for search/archival; the index can reference both MD and original PDF.
    Example: python3 ../Scripts/tools_pdf_to_md_textonly.py /path/to/one.pdf --out-dir Doc/md_outputs python3 ../Scripts/tools_pdf_to_md_textonly.py Doc --out-dir Doc/md_outputs # convert all PDFs in Doc/
    Options to use: --overwrite to replace existing md; check script help for other flags.
    Caveats: Text-only extraction only — scanned/image PDFs need OCR first (tesseract). Install PyMuPDF and html2text: pip install pymupdf html2text.

../Scripts/tools_convert_and_sync_Version7.py

    Purpose: Orchestrator/wrapper that runs PDF→MD conversion then runs the sync script.
    When to run: When you want a one-command run to convert PDFs then sync.
    Why: Convenience. Use when you want to combine convert + sync in a single step.
    Example: python3 ../Scripts/tools_convert_and_sync_Version7.py --doc Doc --md Doc/md_outputs --converter /Users/you/.../tools_pdf_to_md_textonly.py --overwrite-md
    Caveats: Make sure --converter path is expanded (avoid "~" unless script expands it). If wrapper spawns subprocesses you may have seen fork issues on macOS — use the wrapper that runs in-process if that was modified.

../Scripts/tools_generate_doc_index.py

    Purpose: The original index generator (machine-generated HTML) — builds Doc/index.html from Doc/ and Doc/md_outputs/.
    When to run: When you want to regenerate the whole interactive index from the source files (md and pdf).
    Why: If you changed many source files and prefer the programmatic canonical index rather than manual edits.
    Example: python3 ../Scripts/tools_generate_doc_index.py --doc Doc --md Doc/md_outputs --out Doc/index.html
    Caveats: If you made manual edits to index.html that are not generated by this script, regenerating will overwrite them. Keep manual edits minimal OR maintain the generator inputs.

../Scripts/tools_sync_index_with_fs_orig.py

    Purpose: The interactive sync implementation — compares Doc/ + Doc/md_outputs/ to Doc/index.html and interactively adds unreferenced files (asks for category, title, description).
    When to run: After converting PDFs or adding new files, to add entries for files not already in index.html.
    Why: Keeps index updated without fully regenerating; lets you manually choose categories and descriptions.
    Example: python3 ../Scripts/tools_sync_index_with_fs_orig.py --doc Doc --md Doc/md_outputs --index Doc/index.html python3 ../Scripts/tools_sync_index_with_fs_orig.py --yes-to-all ... # if supported, non-interactive defaults
    Caveats: It inserts entries based on patterns; check inserted entries and backups (index.html.bak.*).

../Scripts/tools_sync_index_with_fs.py

    Purpose: Wrapper/orchestrator that calls the real sync implementation (orig) or a fallback; some versions were modified to run helper scripts in-process to avoid fork errors.
    When to run: If you prefer an orchestrator that can also run the converter first (--convert-pdfs) and then call the interactive sync.
    Why: To automate convert + sync while avoiding macOS fork/exec errors (the modified wrapper runs scripts in-process).
    Example: python3 ../Scripts/tools_sync_index_with_fs.py --convert-pdfs --doc Doc --md Doc/md_outputs --index Doc/index.html --overwrite-md
    Caveats: Ensure the wrapper points to the correct orig/fallback script path (use --orig-script / --fallback-script if needed). Avoid a configuration where it tries to execute itself (you previously saw recursion); the wrapper should refuse to run itself.

../Scripts/tools_merge_duplicate_categories_Version2.py

    Purpose: Detect and merge duplicate <section class="category"> blocks (categories with identical display names) into the first occurrence, consolidating <li> entries and deduplicating by data-path.
    When to run: After running the sync or any automated process that might have created multiple sections with the same title (e.g., multiple "Junk" sections).
    Why: Keeps index.html tidy and avoids multiple identical headings.
    Example (dry-run first): python3 ../Scripts/tools_merge_duplicate_categories_Version2.py --index Doc/index.html --dry-run python3 ../Scripts/tools_merge_duplicate_categories_Version2.py --index Doc/index.html
    Caveats: The script makes a timestamped backup Doc/index.html.bak.* before writing. Inspect the dry-run output before committing.

../Scripts/tools_reassign_index_entries_Version2.py

    Purpose: Interactive tool to move one or more <li class="file"> entries between existing categories (or create a new category), updating tags.
    When to run: When entries are in the wrong category (you already used this) or you want to restructure.
    Why: Provides controlled, previewed editing with backups.
    Example: python3 ../Scripts/tools_reassign_index_entries_Version2.py --index Doc/index.html
    Caveats: Works on the HTML structure the index generator uses; always confirm save (backups made). You can move multiple entries via ranges (e.g., "1,3-5" or "all").

../Scripts/tools_unreferences_files.py

    Purpose: Scan Doc/ and Doc/md_outputs/ and list files that are not referenced in Doc/index.html (report-only).
    When to run: After syncing/reassigning to verify there are no stray files left unindexed, or when doing cleanup.
    Why: Ensures on-disk files are represented in the index (or intentionally excluded).
    Example: python3 ../Scripts/tools_unreferences_files.py --doc Doc --md Doc/md_outputs --index Doc/index.html
    Caveats: Skips dotfiles and common temp files depending on script logic; good for final verification.

../Scripts/tools_connect_md_to_pdf_index.py

    Purpose: (You created/ran this) Automatically attach md_outputs/*.md into the same category as an already-indexed PDF with the same stem — inserts md entries next to existing PDF entries.
    When to run: After converting PDFs to MD and the PDF already has an index entry, to “connect” the MD to the PDF so both appear in the same category.
    Why: Avoids duplicated manual insertion; keeps MD and PDF paired together.
    Example (dry-run first): python3 ../Scripts/tools_connect_md_to_pdf_index.py --doc Doc --md Doc/md_outputs --index Doc/index.html --dry-run python3 ../Scripts/tools_connect_md_to_pdf_index.py --doc Doc --md Doc/md_outputs --index Doc/index.html
    Caveats: Only attaches MDs when a corresponding PDF entry already exists; creates a backup before writing.

Safety and operational tips

    Always dry-run first where supported (--dry-run) and inspect planned changes.
    Backups: every mutating script creates Doc/index.html.bak.YYYYMMDDHHMMSS; keep the one you need and remove the rest when satisfied.
    Restore: cp Doc/index.html.bak.YYYYMMDDHHMMSS Doc/index.html
    Use absolute paths or ensure the wrapper expands "" — avoid passing "" to scripts that don't expand it.
    macOS fork errors: prefer the in-process runpy wrapper if you saw BlockingIOError Errno 35. If you must spawn a subprocess, use a full path and ensure system limits are adequate (ulimit).
    Dependency installation (macOS): brew install poppler # provides pdftotext if you use pdftotext fallbacks pip install pymupdf html2text pdfminer.six # as needed
    Avoid committing index HTML backups (add to .gitignore): echo "Doc/index.html.bak*" >> .gitignore echo ".DS_Store" >> .gitignore

Housekeeping suggestions (after you finish reassigning)

    Remove .DS_Store and temporary files: find . -name '.DS_Store' -print -delete find . -name '~$*' -print -delete
    Commit index and housekeeping changes: git add Doc/index.html .gitignore git commit -m "docs: update Doc/index.html and ignore backups and Finder junk" git push origin HEAD

Short checklist to finish (you likely already did many of these)

    Convert PDFs you want as MD (tools_pdf_to_md_textonly.py)
    Dry-run connect MD→PDF (tools_connect_md_to_pdf_index.py --dry-run)
    Write connect and verify, or run sync to add missing files (sync script)
    Merge duplicate categories (merge_duplicate_categories --dry-run then run)
    Reassign entries for correctness (reassign script)
    Run tools_unreferences_files.py to confirm none left unintentionally unindexed
    Clean backups and update .gitignore; commit

